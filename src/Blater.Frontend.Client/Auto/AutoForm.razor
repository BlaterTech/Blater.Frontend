@using Blater.Frontend.Client.Auto.AutoBuilders.Form
@using Blater.Frontend.Client.Interfaces

@typeparam T where T : Blater.Models.Bases.BaseDataModel

@inject ILocalizationService LocalizationService

<MudCard Elevation="0" Class="pa-4 mb-2">
    <MudText Typo="Typo.h5">
        @if (FormBuilder.EditMode)
        {
            @LocalizationService.GetValue($"FormEdit-Title-{_typeName}")
        }
        else
        {
            @LocalizationService.GetValue($"FormCreate-Title-{_typeName}")
        }
    </MudText>
</MudCard>

<MudCard Elevation="0" Class="pa-4">
    <AutoFormBuilder
        @ref="@FormBuilder"
        T="T"
        Id="@Id"
        Model="@Model"
        BeforeUpsert="@BeforeUpsert"/>
</MudCard>

@code {
    private readonly string _typeName = typeof(T).Name;

    [Parameter]
    public Guid? Id { get; set; }

    [Parameter]
    public T? Model { get; set; }

    [Parameter]
    public Func<T, Task<bool>>? BeforeUpsert { get; set; }

    private AutoFormBuilder<T> FormBuilder { get; set; } = null!;

}